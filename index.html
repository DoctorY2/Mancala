<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Gebeta ¬∑ Mancala</title>

<style>
body {
  margin: 0;
  font-family: "Georgia", serif;
  background: radial-gradient(circle, #4a2c16, #1a0e06);
  color: #f3e3c3;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

#game {
  background: linear-gradient(#5a381c, #2b160a);
  padding: 30px 40px;
  border-radius: 30px;
  box-shadow: 0 0 40px rgba(0,0,0,0.6);
  text-align: center;
}

h1 {
  margin-top: 0;
}

#status {
  margin: 15px 0;
  font-size: 18px;
  min-height: 24px;
}

#board {
  display: grid;
  grid-template-columns: 90px repeat(6, 90px) 90px;
  grid-template-rows: repeat(2, 90px);
  gap: 12px;
  justify-content: center;
}

.pit, .store {
  background: #a26a3a;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
  transition: transform 0.2s, background 0.2s;
}

.store {
  grid-row: span 2;
  border-radius: 25px;
  background: #7a4a24;
  font-size: 26px;
}

.pit:hover {
  transform: scale(1.08);
  background: #c48a55;
}

.disabled {
  opacity: 0.35;
  pointer-events: none;
}
</style>
</head>

<body>

<div id="game">
  <h1>Gebeta ¬∑ Mancala</h1>
  <div id="status"></div>
  <div id="board"></div>
</div>

<script>
let board = [
  4,4,4,4,4,4,
  0,
  4,4,4,4,4,4,
  0
];

let currentPlayer = 1;
let gameOver = false;

const boardDiv = document.getElementById("board");
const statusDiv = document.getElementById("status");

function render() {
  boardDiv.innerHTML = "";

  // Fila superior (IA)
  boardDiv.appendChild(createStore(13));
  for (let i = 12; i >= 7; i--) boardDiv.appendChild(createPit(i));
  boardDiv.appendChild(document.createElement("div"));

  // Fila inferior (Jugador)
  boardDiv.appendChild(document.createElement("div"));
  for (let i = 0; i <= 5; i++) boardDiv.appendChild(createPit(i));
  boardDiv.appendChild(createStore(6));

  if (!gameOver) {
    statusDiv.textContent =
      currentPlayer === 1 ? "Tu turno" : "Turno de la IA...";
  }
}

function createPit(i) {
  const d = document.createElement("div");
  d.className = "pit";
  d.textContent = board[i];

  const isPlayer = i >= 0 && i <= 5;
  const isIA = i >= 7 && i <= 12;

  if (
    board[i] === 0 ||
    (currentPlayer === 1 && !isPlayer) ||
    (currentPlayer === 2 && !isIA) ||
    gameOver
  ) {
    d.classList.add("disabled");
  } else if (currentPlayer === 1) {
    d.onclick = () => move(i);
  }

  return d;
}

function createStore(i) {
  const d = document.createElement("div");
  d.className = "store";
  d.textContent = board[i];
  return d;
}

function move(start) {
  let stones = board[start];
  board[start] = 0;
  let i = start;

  while (stones > 0) {
    i = (i + 1) % 14;

    if (
      (currentPlayer === 1 && i === 13) ||
      (currentPlayer === 2 && i === 6)
    ) continue;

    board[i]++;
    stones--;
  }

  // Captura
  if (
    board[i] === 1 &&
    ((currentPlayer === 1 && i >= 0 && i <= 5) ||
     (currentPlayer === 2 && i >= 7 && i <= 12))
  ) {
    let opposite = 12 - i;
    let store = currentPlayer === 1 ? 6 : 13;

    if (board[opposite] > 0) {
      board[store] += board[opposite] + 1;
      board[i] = 0;
      board[opposite] = 0;
    }
  }

  let storeIndex = currentPlayer === 1 ? 6 : 13;
  if (i !== storeIndex) currentPlayer = currentPlayer === 1 ? 2 : 1;

  checkEnd();
  render();

  if (currentPlayer === 2 && !gameOver) {
    setTimeout(aiMove, 700);
  }
}

function aiMove() {
  let options = [];
  for (let i = 7; i <= 12; i++) {
    if (board[i] > 0) options.push(i);
  }
  if (options.length === 0) return;

  let choice = options[Math.floor(Math.random() * options.length)];
  move(choice);
}

function checkEnd() {
  let p1Empty = board.slice(0,6).every(x => x === 0);
  let p2Empty = board.slice(7,13).every(x => x === 0);

  if (p1Empty || p2Empty) {
    for (let i = 0; i < 6; i++) {
      board[6] += board[i];
      board[i] = 0;
    }
    for (let i = 7; i < 13; i++) {
      board[13] += board[i];
      board[i] = 0;
    }

    gameOver = true;

    if (board[6] > board[13]) {
      statusDiv.textContent = "üèÜ ¬°Has ganado!";
    } else if (board[13] > board[6]) {
      statusDiv.textContent = "ü§ñ Gana la IA";
    } else {
      statusDiv.textContent = "ü§ù Empate";
    }
  }
}

render();
</script>

</body>
</html>
